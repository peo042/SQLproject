<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/hoffm/Downloads/AdventureWorks.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="1"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="3138"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,5:mainFinal"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Address" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="76"/><column index="2" value="231"/><column index="3" value="165"/><column index="4" value="124"/><column index="5" value="114"/><column index="6" value="80"/><column index="7" value="300"/><column index="8" value="264"/><column index="9" value="118"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="BoughtBike" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="84"/><column index="2" value="93"/><column index="3" value="73"/><column index="4" value="156"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Final" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="84"/><column index="2" value="80"/><column index="3" value="125"/><column index="4" value="127"/><column index="5" value="96"/><column index="6" value="124"/><column index="7" value="54"/><column index="8" value="92"/><column index="9" value="161"/><column index="10" value="114"/><column index="11" value="89"/><column index="12" value="111"/><column index="13" value="130"/><column index="14" value="124"/><column index="15" value="40"/><column index="16" value="40"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Predictors" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="84"/><column index="2" value="80"/><column index="3" value="125"/><column index="4" value="127"/><column index="5" value="96"/><column index="6" value="124"/><column index="7" value="54"/><column index="8" value="92"/><column index="9" value="161"/><column index="10" value="114"/><column index="11" value="89"/><column index="12" value="111"/><column index="13" value="130"/><column index="14" value="124"/><column index="15" value="40"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Product" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="73"/><column index="2" value="204"/><column index="3" value="108"/><column index="4" value="67"/><column index="5" value="123"/><column index="6" value="73"/><column index="7" value="121"/><column index="8" value="94"/><column index="9" value="97"/><column index="10" value="63"/><column index="11" value="40"/><column index="12" value="147"/><column index="13" value="167"/><column index="14" value="54"/><column index="15" value="138"/><column index="16" value="85"/><column index="17" value="41"/><column index="18" value="41"/><column index="19" value="156"/><column index="20" value="111"/><column index="21" value="113"/><column index="22" value="113"/><column index="23" value="122"/><column index="24" value="264"/><column index="25" value="118"/></column_widths><filter_values><column index="19" value="1"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="PurchaseOrderDetail" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="119"/><column index="2" value="156"/><column index="3" value="118"/><column index="4" value="68"/><column index="5" value="73"/><column index="6" value="65"/><column index="7" value="67"/><column index="8" value="90"/><column index="9" value="89"/><column index="10" value="83"/><column index="11" value="118"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="PurchaseOrderHeader" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="119"/><column index="2" value="111"/><column index="3" value="51"/><column index="4" value="83"/><column index="5" value="69"/><column index="6" value="98"/><column index="7" value="118"/><column index="8" value="118"/><column index="9" value="74"/><column index="10" value="67"/><column index="11" value="67"/><column index="12" value="81"/><column index="13" value="118"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="PurchasesOrderHeader" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="119"/><column index="2" value="111"/><column index="3" value="51"/><column index="4" value="83"/><column index="5" value="69"/><column index="6" value="98"/><column index="7" value="76"/><column index="8" value="66"/><column index="9" value="64"/><column index="10" value="57"/><column index="11" value="53"/><column index="12" value="65"/><column index="13" value="93"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="SalesOrderDetail" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="93"/><column index="2" value="130"/><column index="3" value="156"/><column index="4" value="68"/><column index="5" value="73"/><column index="7" value="67"/><column index="8" value="121"/><column index="9" value="88"/><column index="10" value="265"/><column index="11" value="116"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="SalesOrderHeader" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="93"/><column index="2" value="111"/><column index="3" value="117"/><column index="4" value="117"/><column index="5" value="117"/><column index="6" value="51"/><column index="7" value="109"/><column index="8" value="128"/><column index="9" value="154"/><column index="10" value="111"/><column index="11" value="84"/><column index="12" value="73"/><column index="13" value="101"/><column index="14" value="80"/><column index="15" value="108"/><column index="16" value="118"/><column index="17" value="98"/><column index="18" value="102"/><column index="19" value="112"/><column index="20" value="81"/><column index="21" value="74"/><column index="22" value="67"/><column index="23" value="81"/><column index="24" value="68"/><column index="25" value="264"/><column index="26" value="117"/></column_widths><filter_values><column index="11" value="29825"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">CREATE TABLE Predictors AS
SELECT c.CustomerID, c.TerritoryID, p.TotalPurchaseYTD, p.DateFirstPurchase, p.MaritalStatus,
		p.YearlyIncome, p.Gender, p.TotalChildren, p.NumberChildrenAtHome, p.Education,
		p.Occupation, p.HomeOwnerFlag, p.NumberCarsOwned, p.CommuteDistance,
		(2007-substr(p.BirthDate, 7)) AS Age
FROM Customer c, Person p
WHERE p.BusinessEntityID = c.PersonID AND p.PersonType= 'IN'
ORDER BY c.CustomerID;

CREATE TABLE BoughtBike AS
SELECT DISTINCT h.CustomerID
FROM SalesOrderHeader h
LEFT JOIN SalesOrderDetail d ON h.SalesOrderID = d.SalesOrderID
LEFT JOIN Product p ON d.ProductID = p.ProductID
WHERE p.ProductSubcategoryID = 1 OR p.ProductSubcategoryID = 2 OR p.ProductSubcategoryID = 3
ORDER BY h.CustomerID;

CREATE TABLE Final AS
SELECT p.CustomerID, p.TerritoryID, p.TotalPurchaseYTD, p.DateFirstPurchase, p.MaritalStatus,
		p.YearlyIncome, p.Gender, p.TotalChildren, p.NumberChildrenAtHome, p.Education,
		p.Occupation, p.HomeOwnerFlag, p.NumberCarsOwned, p.CommuteDistance, p.Age,
		CASE
			WHEN b.CustomerID is NOT NULL THEN '1'
			ELSE '0'
		END AS Bike
FROM Predictors p LEFT JOIN BoughtBike b ON p.CustomerID = b.CustomerID;</sql><current_tab id="0"/></tab_sql></sqlb_project>
